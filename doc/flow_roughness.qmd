

# 底面粗度

底面粗度は、河床と水流の間の摩擦を表現するもので、Nays2DHのモデルにおいて流れの計算に重要な役割を果たす。

## Manningの粗度係数

Nays2DHでは、底面粗度の表現にManningの粗度係数$n$を使用している。底面せん断応力$\tau_0$は次式で表される。

$$
\tau_0 = \rho C_f (u^2 + v^2)
$$

ここで底面摩擦係数$C_f$は、Manningの粗度係数$n$を用いて次のように表される。

$$
C_f = \frac{gn^2}{h^{1/3}}
$$

ここで、$g$は重力加速度、$h$は水深である。

## コードにおける実装

Nays2DHのコードでは、以下のように粗度係数が設定され、底面摩擦が計算されている。

```fortran
do j=1,ny
  do i=1,nx
    snmm(i,j)=roughness4(i,j)
    if(snmm(i,j)<=0.d0) then
      write(*,'(a30,i5,a1,i5,a4,f10.3)') &
        'Manning roughness coefficient(',i,',',j,') is',snmm(i,j)
      write(*,*) 'This coefficient should be larger than 0'
      stop
    end if
  end do
end do
```

また、底面摩擦係数と底面せん断応力は以下のように計算される。

```fortran
cf(i,j) = g * snmm(i,j)**2 / hs(i,j)**(1.d0/3.d0)
usta(i,j) = cf(i,j)**0.5d0*vti(i,j)
tausta(i,j) = usta(i,j)**2.d0/(spec*g*diam)
```

ここで：
- `cf(i,j)` は底面摩擦係数$C_f$
- `usta(i,j)` は摩擦速度$u_*$（水流が河床に及ぼすせん断力を速度の次元で表したもの）
- `tausta(i,j)` は無次元化された底面せん断応力（シールズ数とも呼ばれる）
- `vti(i,j)` は流速ベクトルの大きさ$\sqrt{u^2 + v^2}$
- `spec` は砂粒の水中比重
- `diam` は河床材料の代表粒径

この計算は、Nays2DHの`taustacal_uni`と`taustacal_mix`サブルーチン内で実装されており、流速が微小（1e-8未満）または水深が最小値（hmin）未満の場合は、せん断応力と摩擦速度をゼロに設定する条件分岐も含まれている。

## 植生の影響を考慮した底面せん断力の計算

Nays2DHでは植生の影響も考慮した底面せん断力の計算が可能である。この場合、以下のようなコードにより粗度に植生の効果が加味される。

```fortran
c_xi_shear = g * sn_up(i,j)**2 / hs_up**1.33333d0
c_veg = ( cd_veg(i,j) + cd_veg(i+1,j) ) * 0.5d0
h_veg = ( vege_h(i,j)+vege_h(i+1,j) )*0.5d0
h_veg = min( h_veg, hs_up )
                            
c_xi_shear = c_xi_shear + c_veg*h_veg/hs_up

f_xi = - c_xi_shear * vv_up
```

ここで：
- `c_veg` は植生の抵抗係数
- `h_veg` は植生の高さ
- `f_xi` は底面摩擦を含む抵抗力の係数

この実装により、河床の粗度に加えて植生による抵抗が流れに与える影響を適切に表現することができる。

## 粗度設定の考慮事項

実際の河川地形における適切な粗度係数の設定は重要な課題である。粗度係数は以下の要因により変化する。

1. **河床材料**: 砂礫の大きさや分布
2. **河床形状**: 砂堆や砂州の存在
3. **植生状態**: 水草や河畔林の影響
4. **河川の蛇行度**: 断面形状の複雑さ

### 粗度係数の推定

実際の河川において粗度係数を推定する方法としては、以下のアプローチがある。

1. **既往文献の参照値**: 河川の種類や特性に応じた一般的な値
2. **実測データからの逆算**: 水位・流量観測データからの逆算
3. **経験式による推定**: 河床材料の粒径などから推定

### 代表的な粗度係数の値

| 河川の状態 | Manningの粗度係数 $n$ |
|------------|------------------------|
| 滑らかな河床 | 0.020 - 0.035 |
| 砂利河床 | 0.030 - 0.050 |
| 植生のある河床 | 0.035 - 0.070 |
| 岩盤河床 | 0.025 - 0.045 |

## 底面せん断応力の物理的意味と重要性

底面せん断応力$\tau_0$は、流れが河床に及ぼす力を表し、単位面積あたりの力（N/m²）の次元を持つ。この値は以下のような河川プロセスに重要な影響を与える：

1. **河床変動**: 底面せん断応力が河床材料の移動限界を超えると、河床材料が移動を始め、侵食や堆積を引き起こす
2. **流砂量**: 無次元せん断応力（tausta）は、流砂量式の主要なパラメータとして用いられる
3. **河川形態**: 長期的な底面せん断応力の分布は、河道形状の変化や河床形態（砂堆、砂州）の形成に影響する

Nays2DHでは、底面せん断応力を適切に計算することで、これらの現象を精度よくシミュレーションすることが可能となっている。

## 空間分布の表現

Nays2DHでは、計算領域内の各格子点において異なる粗度係数を設定することが可能である。これにより、河川の縦断方向・横断方向の粗度変化を考慮した詳細な計算が可能となる。河床材料の変化や植生の分布を反映した粗度分布を与えることで、より現実的な流れ場のシミュレーションが実現できる。 
