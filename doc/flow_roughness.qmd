# 底面粗度

底面粗度は、河床と水流の間の摩擦を表現するもので、Nays2DHのモデルにおいて流れの計算に重要な役割を果たします。

## Manningの粗度係数

Nays2DHでは、底面粗度の表現にManningの粗度係数$n$を使用しています。底面せん断応力$\tau_0$は次式で表されます。

$$
\tau_0 = \rho C_f (u^2 + v^2)
$$

ここで底面摩擦係数$C_f$は、Manningの粗度係数$n$を用いて次のように表されます。

$$
C_f = \frac{gn^2}{h^{1/3}}
$$

ここで、$g$は重力加速度、$h$は水深です。

## コードにおける実装

Nays2DHのコードでは、以下のように粗度係数が設定され、底面摩擦が計算されています。

```fortran
do j=1,ny
  do i=1,nx
    snmm(i,j)=roughness4(i,j)
    if(snmm(i,j)<=0.d0) then
      write(*,'(a30,i5,a1,i5,a4,f10.3)') &
        'Manning roughness coefficient(',i,',',j,') is',snmm(i,j)
      write(*,*) 'This coefficient should be larger than 0'
      stop
    end if
  end do
end do
```

また、底面摩擦係数と底面せん断応力は以下のように計算されます。

```fortran
cf(i,j) = g * snmm(i,j)**2 / hs(i,j)**(1.d0/3.d0)
usta(i,j) = cf(i,j)**0.5d0*vti(i,j)
tausta(i,j) = usta(i,j)**2.d0/(spec*g*diam)
```

## 粗度設定の考慮事項

実際の河川地形における適切な粗度係数の設定は重要な課題です。粗度係数は以下の要因により変化します。

1. **河床材料**: 砂礫の大きさや分布
2. **河床形状**: 砂堆や砂州の存在
3. **植生状態**: 水草や河畔林の影響
4. **河川の蛇行度**: 断面形状の複雑さ

### 粗度係数の推定

実際の河川において粗度係数を推定する方法としては、以下のアプローチがあります。

1. **既往文献の参照値**: 河川の種類や特性に応じた一般的な値
2. **実測データからの逆算**: 水位・流量観測データからの逆算
3. **経験式による推定**: 河床材料の粒径などから推定

### 代表的な粗度係数の値

| 河川の状態 | Manningの粗度係数 $n$ |
|------------|------------------------|
| 滑らかな河床 | 0.020 - 0.035 |
| 砂利河床 | 0.030 - 0.050 |
| 植生のある河床 | 0.035 - 0.070 |
| 岩盤河床 | 0.025 - 0.045 |

## 空間分布の表現

Nays2DHでは、計算領域内の各格子点において異なる粗度係数を設定することが可能です。これにより、河川の縦断方向・横断方向の粗度変化を考慮した詳細な計算が可能になります。 
